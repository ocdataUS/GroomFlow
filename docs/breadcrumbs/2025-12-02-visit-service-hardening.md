# Breadcrumb
- **Task asked:** Visit_Service query hardening & PHPCS scope (Asana `1212222559037364`)
- **Plan:** Review Visit_Service DB queries/PHPCS suppressions, refactor to prepared statements or narrow ignores without breaking payload/build logic, then rebuild ZIP, Docker install/reseed, run qa-phpcs + admin/board smoke, and log artifacts/breadcrumb updates.
- **Files changed:** `plugin/bb-groomflow/includes/data/class-visit-service.php`; `qa/QA_LOG.md`; `docs/REFACTOR_LOG.md`; `docs/breadcrumbs/2025-12-02-visit-service-hardening.md`
- **Commands executed:** `ssh-agent` + `ssh-add ~/.ssh/id_ed25519_codex`; `ssh -T git@github.com`; `git status`; `ocasana tasks list/show/comment/update/move` (locked Asana `1212222559037364` into Doing); `git checkout dev` → `git checkout -b refactor/visit-service-hardening`; `bash scripts/build_plugin_zip.sh`; `docker compose up -d`; `docker compose cp ../build/bb-groomflow-0.1.0-dev.zip wordpress:/var/www/html/bb-groomflow.zip`; `docker compose run --rm -T wpcli wp plugin install /var/www/html/bb-groomflow.zip --force --activate`; `docker compose run --rm -T wpcli wp bbgf visits seed-demo --count=8 --force`; `qa-phpcs plugin/bb-groomflow`; Manual admin happy-path via WP-CLI updates (Clients→Settings tables) → `/opt/qa/artifacts/manual-admin-happy-path-20251202T172926Z.txt`; Board smoke `wp bbgf visits list --limit=5` → `/opt/qa/artifacts/board-list-20251202T173003Z.txt`
- **Tests & results:** PHPCS PASS (`qa-phpcs plugin/bb-groomflow` → `/opt/qa/artifacts/phpcs-1764696502.txt`); Manual admin happy-path (WP-CLI edits across Clients→Settings) PASS (`/opt/qa/artifacts/manual-admin-happy-path-20251202T172926Z.txt`); Board visits list smoke PASS (`/opt/qa/artifacts/board-list-20251202T173003Z.txt`)
- **Tips & Tricks:** `qa-phpcs` wrapper treats the second argument as the artifact path—avoid passing flags like `-s` or you’ll overwrite a target file; increase `timeout_ms` when chaining multiple `docker compose run` QA commands.
- **Remaining work:** Update Asana task `1212222559037364` with results/status; consider syncing notes to QA/Asana if additional PHPCS tightening is needed elsewhere.
