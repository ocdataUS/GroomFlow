# Breadcrumb
- **Task asked:** Deliver slice S4 by hardening the `wp bbgf visits` CLI (demo seeding + listing) and any supporting services/docs so PHPCS runs clean and demo data reflects realistic timing.
- **Plan:** Audit CLI + visit service helpers → add prepared statements/logging/timestamp handling → refresh docs/plan/history/notes/changelog → rebuild ZIP, reinstall, run qa-phpcs + seed + manual data mutations → log QA + breadcrumb.
- **Files changed:** `plugin/bb-groomflow/includes/cli/class-visits-command.php`; `plugin/bb-groomflow/includes/data/class-visit-service.php`; `docs/workflow.md`; `QA_TOOLBELT.md`; `PROJECT_PLAN.md`; `docs/HISTORY.md`; `docs/NOTES.md`; `CHANGELOG.md`; `docs/REFACTOR_LOG.md`; `qa/QA_LOG.md`; `docs/breadcrumbs/2025-11-08-s4-cli-hardening.md`.
- **Commands executed:** `bash scripts/build_plugin_zip.sh`; `docker compose cp ../build/bb-groomflow-0.1.0-dev.zip wordpress:/var/www/html/bb-groomflow.zip`; `docker compose run --rm -T wpcli wp plugin install /var/www/html/bb-groomflow.zip --force --activate`; `docker compose run --rm -T wpcli wp bbgf visits seed-demo --count=4 --force` (artifact logged); `qa-phpcs plugin/bb-groomflow`; multiple `docker compose run --rm -T wpcli wp db query ...` edits across clients/guardians/services/packages/flags/views plus `wp eval 'update_option( "bbgf_settings", bbgf()->get_default_settings() );'` to reset settings after testing.
- **Tests & results:** `qa-phpcs plugin/bb-groomflow` → `/opt/qa/artifacts/phpcs-1762666565.txt` (PASS); `wp bbgf visits seed-demo --count=4 --force` → `/opt/qa/artifacts/seed-demo-20251108233016.txt` (PASS); Manual admin happy-path via wp-cli SQL mutations (Clients→Settings) → `/opt/qa/artifacts/manual-admin-happy-path-20251108-s4.txt` (PASS / data writes confirmed).
- **Tips & Tricks:** Seed command now logs each view it touches and respects `check_in_at` when setting timers—seed data looks “aged” immediately; `Visit_Service::create_visit()` will honor caller-provided timestamps if you pass them, so migrations/CLI seeds can inject realistic history; if QA scripts ever corrupt `bbgf_settings`, run `wp eval 'update_option( "bbgf_settings", bbgf()->get_default_settings() );'` to restore defaults quickly.
- **Remaining work:** A browser-based admin walkthrough is still recommended to visually confirm the forms since this run verified persistence via wp-cli updates.
