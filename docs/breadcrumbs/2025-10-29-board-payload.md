# Breadcrumb
- **Task asked:** Continue Sprint 2 by tightening the `/board` payload (stage metadata + public masking) and keep the runway clear for the upcoming notifications work.
- **Plan:** 1) Re-read Sprint 2 requirements and audit the current controller gaps. 2) Update the Visits REST controller to deliver ordered stage metadata and scrub sensitive data when masking is required. 3) Refresh docs + run QA (PHPCS, build/install ZIP, REST smoke checks). 4) Capture artifacts/tips and outline next Sprint 2 steps.
- **Files changed:** plugin/bb-groomflow/includes/api/class-visits-controller.php; docs/API.md; docs/breadcrumbs/2025-10-29-board-payload.md
- **Commands executed:** `qa-phpcs plugin/bb-groomflow`; `qa-phpcbf plugin/bb-groomflow/includes/api/class-visits-controller.php`; `bash scripts/build_plugin_zip.sh`; `docker compose cp ../build/bb-groomflow-0.1.0-dev.zip wordpress:/var/www/html/bb-groomflow-0.1.0-dev.zip`; `docker compose run --rm -T wpcli wp plugin install /var/www/html/bb-groomflow-0.1.0-dev.zip --force --activate`; `docker compose run --rm -T wpcli wp eval 'wp_set_current_user( 1 ); $request = new WP_REST_Request( "GET", "/bb-groomflow/v1/board" ); $response = rest_do_request( $request ); print_r( $response->get_data() );'`; `docker compose run --rm -T wpcli wp db query "UPDATE wp_7ptz4bz8ht_bb_views SET show_guardian = 0, type = 'lobby' WHERE id = 1"` (and revert back to `show_guardian = 1, type = 'internal'`); `docker compose exec wordpress sh -c 'rm -f /var/www/html/bb-groomflow-0.1.0-dev.zip'`
- **Tests & results:** `qa-phpcs` clean (`/opt/qa/artifacts/phpcs-1761749394.txt`). WP-CLI REST checks confirm `/board` now returns ordered stage metadata + `visibility` flags for both internal and lobby views; masking removes guardian/sensitive fields once the view type flips to `lobby`, and restoring the view resets masking.
- **Tips & Tricks:** Use `docker compose run --rm -T wpcli wp db query "UPDATE wp_7ptz4bz8ht_bb_views SET type = 'lobby', show_guardian = 0 WHERE id = 1"` to simulate lobby mode for QA; run the inverse update afterwards to leave the database tidy.
- **Remaining work:** Sprint 2 still needs the visit-notification scaffolding and deeper `/board` payload polish (e.g., guardian masking for hashed public tokens + service/flag shaping for the public feed). Notifications engine + REST tests remain outstanding.
